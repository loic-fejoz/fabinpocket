<!DOCTYPE html>
<!--HTML5 doctype-->
<html>
<head>
    <title>FabInPocket</title>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8"></meta>
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=1, minimal-ui"></meta>
    <script src="js/jquery-2.1.4.min.js"></script>
    <link rel="stylesheet" type="text/css" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="fabinpocket.css" media="screen" />
  </head>
  <body>
    <div id="wrap">
      <div id="preview" class="part">
	<div class="headline preview-headline"><h1>FabInPocket</h1> <i id="loading-container"></i><span id="fps-container">FPS: <span id='fps'></span> </span> <a href="https://github.com/loic-fejoz/fabinpocket">Documentation</a></div>
	<div class="canvas-wrapper is-active" id="preview-wrapper">
	  <canvas id="previewcanvas">
	    Your browser doesn't appear to support the HTML5 <code>&lt;canvas&gt;</code> element.
      	  </canvas>
	  </div>
    </div>
      <div id="editpart" class="part">
	<div class="headline edit-headline">
	  <ul role="nav" id="nav">
	    <li><a href="#shape-wrapper" class="tabs__tab is-active">1. Shape</a></li>
	    <li><a href="#engrave-tabs" class="tabs__tab">2. Engrave</a></li>
	    <li><a href="#print-tabs" class="tabs__tab">3. Print</a></li>
	    <li id="menu-wrapper"><a href="#menu" id="menu-button"><i class="fa fa-bars"></i></a>
	      <div class="menu">
		<ul>
		  <li><i class="fa fa-upload"></i> <input type="file" id="file-upload" /></li>
		  <li><button id="clear-btn">Clear</button></li>
		  <li><button id="white-pencil-btn"><i class="fa fa-pencil"></i>White pencil</button></li>
		  <li><button id="black-eraser-btn"><i class="fa fa-eraser"></i>Black erase</button></li>
		  <li><label for="tool-size">Tool radius:</label><input type="number" id="tool-size" value="10" step="1" min="0" max="200" /></li>
		  <li><label for="z-scale">Z scale:</label><input type="number" id="z-scale" value="1" step="0.1" min="0" /></li>
		</ul>
	      </div>
	    </li>
	  </ul>
	</div>
	<div class="canvas-wrapper tabs__panel is-active" id="shape-wrapper">
	  <canvas id="shapecanvas">
	    Your browser doesn't appear to support the HTML5 <code>&lt;canvas&gt;</code> element.
	  </canvas>
	</div>
	<div class="canvas-wrapper tabs__panel" id="engrave-tabs">
	  <p>Not yet implemented.</p>
	</div>
	<div class="canvas-wrapper tabs__panel" id="print-tabs">
	  <p><i class="fa fa-download"></i>Download as
	    <ul>
	      <li><a id="export-stl" href="#" download="fabinpocket.stl" >STL</a>, </li>
	      <li><a id="export-png" href="#" download="fabinpocket.png" >as PNG</a>.</li>
	    </ul>
	  </p>
	  <p>TODO: Send to Octoprint.</p>
	</div>
      </div>
    </div>
    <img src="test-chat2.png" z-scale="1.0" id="heightmap" style="display:none"/>
    <canvas id="computedheightmapcanvas" style="display:none">
      Your browser doesn't ap pear to support the HTML5 <code>&lt;canvas&gt;</code> element.
    </canvas>
  </body>
  <script id="shader-vs" type="x-shader/x-vertex">
  attribute vec3 aVertexPosition_modelspace;

  uniform mat4 uMVMatrix;
  uniform float zMax;

  varying mediump vec4 color;

  void main(void) {
    gl_Position = uMVMatrix *  vec4(aVertexPosition_modelspace, 1.0);
    color = vec4(aVertexPosition_modelspace.z / zMax, aVertexPosition_modelspace.z / zMax, aVertexPosition_modelspace.z / zMax, 1.0);
  }
</script>
<!-- color = vec3(1.0 - (aVertexPosition_modelspace.z / 255.0), aVertexPosition_modelspace.z / 255.0, 0.0); -->
<script id="shader-fs" type="x-shader/x-fragment">
  varying mediump vec4 color;

  void main(void) {
    gl_FragColor = color;
  }
</script>
<script type="text/javascript" src="js/tdl/base.js"></script>
<script type="text/javascript">
  tdl.require('tdl.fast');
  tdl.require('tdl.webgl');
  tdl.require('tdl.programs');
  tdl.require('tdl.fps');
  tdl.require('tdl.math');
  tdl.require('tdl.log');
</script>
<script type="text/javascript">
(function ($) {
    if (document.jQuery === undefined) {
      document.jQuery = $;
    }
})($);
</script>
<script type="text/javascript" src="js/fabinpocket.js"></script>
</html>
